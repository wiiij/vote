drop table TBL_VOTE_202005
create table TBL_VOTE_202005(
	V_JUMIN CHAR(13) NOT NULL PRIMARY KEY,
	V_NAME VARCHAR2(20),
	V_NO CHAR(1),
	V_TIME CHAR(4),
	V_AREA CHAR(25),
	V_CONFIRM CHAR(4)
);

INSERT INTO TBL_VOTE_202005 VALUES('99010110001', '김유권', '1', '0930', '제1투표장', 'N');
INSERT INTO TBL_VOTE_202005 VALUES('99010110002', '이유권', '2', '0930', '제1투표장', 'N');
INSERT INTO TBL_VOTE_202005 VALUES('99010110003', '박유권', '3', '0930', '제1투표장', 'Y');
INSERT INTO TBL_VOTE_202005 VALUES('99010110004', '홍유권', '4', '0930', '제1투표장', 'Y');
INSERT INTO TBL_VOTE_202005 VALUES('99010110005', '조유권', '5', '0930', '제1투표장', 'Y');
INSERT INTO TBL_VOTE_202005 VALUES('99010110006', '최유권', '1', '0930', '제1투표장', 'Y');
INSERT INTO TBL_VOTE_202005 VALUES('99010110007', '지유권', '1', '0930', '제1투표장', 'Y');
INSERT INTO TBL_VOTE_202005 VALUES('99010110008', '장유권', '3', '0930', '제1투표장', 'Y');
INSERT INTO TBL_VOTE_202005 VALUES('99010110009', '정유권', '3', '0930', '제1투표장', 'Y');
INSERT INTO TBL_VOTE_202005 VALUES('99010110010', '강유권', '4', '0930', '제1투표장', 'Y');
INSERT INTO TBL_VOTE_202005 VALUES('99010110011', '신유권', '5', '0930', '제1투표장', 'Y');
INSERT INTO TBL_VOTE_202005 VALUES('99010110012', '오유권', '4', '1330', '제1투표장', 'Y');
INSERT INTO TBL_VOTE_202005 VALUES('99010110013', '현유권', '1', '1330', '제2투표장', 'Y');
INSERT INTO TBL_VOTE_202005 VALUES('99010110014', '왕유권', '2', '1330', '제2투표장', 'Y');
INSERT INTO TBL_VOTE_202005 VALUES('99010110015', '유유권', '3', '1330', '제2투표장', 'Y');
INSERT INTO TBL_VOTE_202005 VALUES('99010110016', '한유권', '2', '1330', '제2투표장', 'Y');
INSERT INTO TBL_VOTE_202005 VALUES('99010110017', '문유권', '4', '1330', '제2투표장', 'Y');
INSERT INTO TBL_VOTE_202005 VALUES('99010110018', '양유권', '2', '1330', '제2투표장', 'Y');
INSERT INTO TBL_VOTE_202005 VALUES('99010110019', '구유권', '4', '1330', '제2투표장', 'Y');
INSERT INTO TBL_VOTE_202005 VALUES('99010110020', '황유권', '5', '1330', '제2투표장', 'Y');
INSERT INTO TBL_VOTE_202005 VALUES('99010110021', '배유권', '3', '1330', '제2투표장', 'Y');
INSERT INTO TBL_VOTE_202005 VALUES('99010110022', '전유권', '3', '1330', '제2투표장', 'Y');
INSERT INTO TBL_VOTE_202005 VALUES('99010110023', '고유권', '1', '1330', '제2투표장', 'Y');
INSERT INTO TBL_VOTE_202005 VALUES('99010110024', '권유권', '3', '1330', '제2투표장', 'Y');

select * from TBL_VOTE_202005

drop table TBL_MEMBER_202005;
CREATE TABLE TBL_MEMBER_202005(
	M_NO CHAR(1) NOT NULL PRIMARY KEY,
	M_NAME VARCHAR2(20),
	P_CODE CHAR(2),
	P_SCHOOL CHAR(1),
	M_JUMIN CHAR(13),
	M_CITY VARCHAR2(20)
);

INSERT INTO TBL_MEMBER_202005 VALUES('1', '김후보', 'P1', '1', '6603011999991', '수선화동');
INSERT INTO TBL_MEMBER_202005 VALUES('2', '이후보', 'P2', '3', '6603011999992', '민들레동');
INSERT INTO TBL_MEMBER_202005 VALUES('3', '박후보', 'P3', '2', '6603011999993', '나팔꽃동');
INSERT INTO TBL_MEMBER_202005 VALUES('4', '조후보', 'P4', '2', '6603011999994', '진달래동');
INSERT INTO TBL_MEMBER_202005 VALUES('5', '최후보', 'P5', '3', '6603011999995', '개나리동');


drop table TBL_PARTY_202005;
CREATE TABLE TBL_PARTY_202005(
	P_CODE CHAR(2) NOT NULL PRIMARY KEY,
	P_NAME VARCHAR2(20),
	P_INDEATE DATE,
	P_READER VARCHAR2(20),
	P_TEL1 CHAR(3),
	P_TEL2 CHAR(4),
	P_TEL3 CHAR(4)
);

INSERT INTO TBL_PARTY_202005 VALUES('P1', 'A정당', '2010-01-01', '위대표', '02', '1111', '0001');
INSERT INTO TBL_PARTY_202005 VALUES('P2', 'B정당', '2010-02-01', '명대표', '02', '1111', '0002');
INSERT INTO TBL_PARTY_202005 VALUES('P3', 'C정당', '2010-03-01', '기대표', '02', '1111', '0003');
INSERT INTO TBL_PARTY_202005 VALUES('P4', 'D정당', '2010-04-01', '옥대표', '02', '1111', '0004');
INSERT INTO TBL_PARTY_202005 VALUES('P5', 'E정당', '2010-05-01', '임대표', '02', '1111', '0005');


select mem.*, pt.*, 
 substr(mem.M_JUMIN,1,6) as f_jumin, substr(mem.M_JUMIN,7,13) as b_jumin,
 case mem.P_SCHOOL 
    when '1' then '고졸'
    when '2' then '학사'
    when '3' then '석사'
    when '4' then '박사'
    end p_schooln
from TBL_MEMBER_202005 mem, TBL_PARTY_202005 pt
where mem.P_CODE = pt.p_code
order by mem.p_code;


SELECT TRUNC(MONTHS_BETWEEN(SYSDATE, TO_DATE(SUBSTR('19'||V_JUMIN,1,8), 'YYYYMMDD'))/12) AS V_AGE FROM tbl_vote_202005;
SELECT TO_DATE(SUBSTR(('19'||V_JUMIN),1,8), 'YYYYMMDD') FROM tbl_vote_202005;

select 
 V_NAME
 ,'19'||SUBSTR(V_JUMIN,1,2)||'년'||SUBSTR(V_JUMIN,3,2)||'월'||SUBSTR(V_JUMIN,5,2)||'일생' AS V_BIRTH
 , TRUNC(MONTHS_BETWEEN(SYSDATE, TO_DATE(SUBSTR('19'||V_JUMIN,1,8), 'YYYYMMDD'))/12) AS V_AGE
 , CASE SUBSTR(V_JUMIN,7,1) WHEN '1' THEN '남자' WHEN '2' THEN '여자' WHEN '3' THEN '남자' WHEN '4' THEN '여자' END AS V_GENDER
 , V_NO
 , SUBSTR(V_TIME,1,2) || ':' || SUBSTR(V_TIME,3,2) AS V_TIME
 , CASE V_CONFIRM WHEN 'Y' THEN '확인' WHEN 'N' THEN '미확인' END AS V_CONFIRM
from TBL_VOTE_202005 where V_AREA = '제1투표장';

select  v_no, m_name, count(*) cnt
from TBL_VOTE_202005 vote, TBL_MEMBER_202005 mem
where vote.v_no=mem.m_no and vote.V_CONFIRM = 'Y'
group by v_no, m_name
order by cnt desc;

